# –≠—Ç–∞–ø 2: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

## üìã –û–±–∑–æ—Ä —ç—Ç–∞–ø–∞

**–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: 1-2 –Ω–µ–¥–µ–ª–∏  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –í–´–°–û–ö–ò–ô  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –≠—Ç–∞–ø 1 (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω—ã)

## üéØ –¶–µ–ª—å —ç—Ç–∞–ø–∞

–°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤: —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π, –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã, –º–æ–∫–∏, —Ñ–∏–∫—Å—Ç—É—Ä—ã –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–°–µ–π—á–∞—Å –Ω–µ—Ç:
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤
- –ú–æ–∫–æ–≤ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –¢–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∏–∫—Å—Ç—É—Ä
- –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É:
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ç–µ—Å—Ç–æ–≤
- –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –∏ —Ö–µ–ª–ø–µ—Ä—ã
- –ú–æ–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
- –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –ë–î

---

## üìù –ó–∞–¥–∞—á–∏ —ç—Ç–∞–ø–∞

### –ó–∞–¥–∞—á–∞ 2.1: –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è —Ç–µ—Å—Ç–æ–≤

**–í—Ä–µ–º—è**: 30 –º–∏–Ω—É—Ç

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å**:
```bash
mkdir -p tests/Unit/MBMigration/{Core,Builder/{Utils,Layout,BrizyComponent},Layer}
mkdir -p tests/Unit/Dashboard/Api/{Controllers,Services}
mkdir -p tests/Integration/{Migration,Api,Database}
mkdir -p tests/E2E/MigrationFlow
mkdir -p tests/Fixtures/{migrations,pages,projects}
mkdir -p tests/Helpers/{Mocks,Factories,Builders}
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞**:
```
tests/
‚îú‚îÄ‚îÄ Unit/                    # Unit —Ç–µ—Å—Ç—ã (–±—ã—Å—Ç—Ä—ã–µ, –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
‚îÇ   ‚îú‚îÄ‚îÄ MBMigration/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Builder/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Layer/
‚îÇ   ‚îî‚îÄ‚îÄ Dashboard/
‚îú‚îÄ‚îÄ Integration/            # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ Migration/
‚îÇ   ‚îú‚îÄ‚îÄ Api/
‚îÇ   ‚îî‚îÄ‚îÄ Database/
‚îú‚îÄ‚îÄ E2E/                    # End-to-end —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ MigrationFlow/
‚îú‚îÄ‚îÄ Fixtures/               # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îî‚îÄ‚îÄ projects/
‚îî‚îÄ‚îÄ Helpers/                 # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã
    ‚îú‚îÄ‚îÄ Mocks/
    ‚îú‚îÄ‚îÄ Factories/
    ‚îî‚îÄ‚îÄ Builders/
```

**–ß–µ–∫–ª–∏—Å—Ç**:
- [ ] –í—Å–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–æ–∑–¥–∞–Ω—ã
- [ ] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–∏—á–Ω–∞ –∏ –ø–æ–Ω—è—Ç–Ω–∞

---

### –ó–∞–¥–∞—á–∞ 2.2: –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å TestCase

**–í—Ä–µ–º—è**: 1 —á–∞—Å  
**–§–∞–π–ª**: `tests/TestCase.php`

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å**:
1. –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
2. –î–æ–±–∞–≤–∏—Ç—å –æ–±—â–∏–µ –º–µ—Ç–æ–¥—ã setUp/tearDown
3. –î–æ–±–∞–≤–∏—Ç—å —Ö–µ–ª–ø–µ—Ä—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–∏–º–µ—Ä**:
```php
<?php

namespace Tests;

use PHPUnit\Framework\TestCase as PHPUnitTestCase;

abstract class TestCase extends PHPUnitTestCase
{
    protected function setUp(): void
    {
        parent::setUp();
        // –û–±—â–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
    }
    
    protected function tearDown(): void
    {
        parent::tearDown();
        // –û—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤
    }
    
    /**
     * –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
     */
    protected function createTestData(string $type): array
    {
        return match($type) {
            'migration' => [
                'migration_uuid' => 'test-uuid-' . uniqid(),
                'brz_project_id' => 12345,
                'mb_project_uuid' => 'mb-uuid-' . uniqid(),
                'status' => 'pending'
            ],
            'project' => [
                'uuid' => 'test-uuid-' . uniqid(),
                'name' => 'Test Project',
                'pages' => []
            ],
            default => []
        };
    }
    
    /**
     * –°–æ–∑–¥–∞—Ç—å –º–æ–∫ –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
     */
    protected function createMock(string $interface): object
    {
        return $this->createMock($interface);
    }
}
```

**–ß–µ–∫–ª–∏—Å—Ç**:
- [ ] –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å —Å–æ–∑–¥–∞–Ω
- [ ] –û–±—â–∏–µ –º–µ—Ç–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [ ] –•–µ–ª–ø–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç

---

### –ó–∞–¥–∞—á–∞ 2.3: –°–æ–∑–¥–∞—Ç—å –º–æ–∫ –¥–ª—è BrizyAPIInterface

**–í—Ä–µ–º—è**: 2-3 —á–∞—Å–∞  
**–§–∞–π–ª**: `tests/Helpers/Mocks/BrizyAPIMock.php`

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å**:
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å BrizyAPIInterface
2. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤
3. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–∑–æ–≤–æ–≤
4. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ reset()

**–ü—Ä–∏–º–µ—Ä**:
```php
<?php

namespace Tests\Helpers\Mocks;

use MBMigration\Contracts\BrizyAPIInterface;

class BrizyAPIMock implements BrizyAPIInterface
{
    private array $responses = [];
    private array $calls = [];
    
    public function setResponse(string $method, $response): void
    {
        $this->responses[$method] = $response;
    }
    
    public function getCalls(string $method): array
    {
        return $this->calls[$method] ?? [];
    }
    
    public function wasCalled(string $method): bool
    {
        return isset($this->calls[$method]) && count($this->calls[$method]) > 0;
    }
    
    public function reset(): void
    {
        $this->responses = [];
        $this->calls = [];
    }
    
    // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    public function createProject(array $data): array
    {
        $this->calls['createProject'][] = $data;
        return $this->responses['createProject'] ?? [
            'id' => 12345,
            'name' => $data['name'] ?? 'Test Project'
        ];
    }
    
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
}
```

**–ß–µ–∫–ª–∏—Å—Ç**:
- [ ] –ú–æ–∫ —Å–æ–∑–¥–∞–Ω
- [ ] –í—Å–µ –º–µ—Ç–æ–¥—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- [ ] –ú–µ—Ç–æ–¥—ã setResponse/getCalls/wasCalled —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ú–µ—Ç–æ–¥ reset() —Ä–∞–±–æ—Ç–∞–µ—Ç

---

### –ó–∞–¥–∞—á–∞ 2.4: –°–æ–∑–¥–∞—Ç—å –º–æ–∫ –¥–ª—è MBProjectDataCollectorInterface

**–í—Ä–µ–º—è**: 2-3 —á–∞—Å–∞  
**–§–∞–π–ª**: `tests/Helpers/Mocks/MBProjectDataCollectorMock.php`

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å**:
–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∑–∞–¥–∞—á–µ 2.3, –Ω–æ –¥–ª—è MBProjectDataCollectorInterface

**–ß–µ–∫–ª–∏—Å—Ç**:
- [ ] –ú–æ–∫ —Å–æ–∑–¥–∞–Ω
- [ ] –í—Å–µ –º–µ—Ç–æ–¥—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- [ ] –ú–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã

---

### –ó–∞–¥–∞—á–∞ 2.5: –°–æ–∑–¥–∞—Ç—å –º–æ–∫ –¥–ª—è DatabaseInterface

**–í—Ä–µ–º—è**: 2-3 —á–∞—Å–∞  
**–§–∞–π–ª**: `tests/Helpers/Mocks/DatabaseMock.php`

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å**:
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å DatabaseInterface
2. –î–æ–±–∞–≤–∏—Ç—å in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
3. –ò–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –•—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –º–∞—Å—Å–∏–≤–∞—Ö
- –ò–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å SELECT/INSERT/UPDATE
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ß–µ–∫–ª–∏—Å—Ç**:
- [ ] –ú–æ–∫ —Å–æ–∑–¥–∞–Ω
- [ ] –ú–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
- [ ] –ò–º–∏—Ç–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –ë–î

---

### –ó–∞–¥–∞—á–∞ 2.6: –°–æ–∑–¥–∞—Ç—å –º–æ–∫ –¥–ª—è S3UploaderInterface

**–í—Ä–µ–º—è**: 1-2 —á–∞—Å–∞  
**–§–∞–π–ª**: `tests/Helpers/Mocks/S3UploaderMock.php`

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å**:
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
2. –ò–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤ (—Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –ø–∞–º—è—Ç—å –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é)

**–ß–µ–∫–ª–∏—Å—Ç**:
- [ ] –ú–æ–∫ —Å–æ–∑–¥–∞–Ω
- [ ] –ú–æ–∂–Ω–æ "–∑–∞–≥—Ä—É–∂–∞—Ç—å" —Ñ–∞–π–ª—ã
- [ ] –ú–æ–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å URL —Ñ–∞–π–ª–æ–≤

---

### –ó–∞–¥–∞—á–∞ 2.7: –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã

**–í—Ä–µ–º—è**: 2-3 —á–∞—Å–∞  
**–§–∞–π–ª—ã**: 
- `tests/Fixtures/projects/mb-project-sample.json`
- `tests/Fixtures/pages/home-page-sample.json`
- `tests/Fixtures/migrations/migration-sample.json`

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å**:
1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ JSON —Ñ–∞–π–ª—ã
3. –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∏–∫—Å—Ç—É—Ä

**–ü—Ä–∏–º–µ—Ä**:
```php
<?php
// tests/Fixtures/FixtureLoader.php

namespace Tests\Fixtures;

class FixtureLoader
{
    public static function load(string $type, string $name): array
    {
        $path = __DIR__ . "/{$type}/{$name}.json";
        if (!file_exists($path)) {
            throw new \RuntimeException("Fixture not found: {$path}");
        }
        
        $content = file_get_contents($path);
        return json_decode($content, true);
    }
}
```

**–ß–µ–∫–ª–∏—Å—Ç**:
- [ ] –§–∏–∫—Å—Ç—É—Ä—ã —Å–æ–∑–¥–∞–Ω—ã –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤
- [ ] –§–∏–∫—Å—Ç—É—Ä—ã —Å–æ–∑–¥–∞–Ω—ã –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü
- [ ] –§–∏–∫—Å—Ç—É—Ä—ã —Å–æ–∑–¥–∞–Ω—ã –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π
- [ ] –ö–ª–∞—Å—Å FixtureLoader —Å–æ–∑–¥–∞–Ω

---

### –ó–∞–¥–∞—á–∞ 2.8: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

**–í—Ä–µ–º—è**: 1-2 —á–∞—Å–∞  
**–§–∞–π–ª**: `.env.test`

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å**:
1. –°–æ–∑–¥–∞—Ç—å `.env.test` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.dev`
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –ë–î (SQLite –¥–ª—è unit —Ç–µ—Å—Ç–æ–≤)
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ API –∫–ª—é—á–∏ (–º–æ–∂–Ω–æ –ø—É—Å—Ç—ã–µ)

**–ü—Ä–∏–º–µ—Ä**:
```env
APP_ENV=test
APP_DEBUG=true

# –¢–µ—Å—Ç–æ–≤–∞—è –ë–î (SQLite)
MG_DB_DRIVER=sqlite
MG_DB_NAME=:memory:

# –¢–µ—Å—Ç–æ–≤—ã–µ API –∫–ª—é—á–∏
BRIZY_API_KEY=test-key
MB_API_KEY=test-key

# –û—Ç–∫–ª—é—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
AWS_BUCKET_ACTIVE=false
```

**–ß–µ–∫–ª–∏—Å—Ç**:
- [ ] .env.test —Å–æ–∑–¥–∞–Ω
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –ë–î
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏

---

### –ó–∞–¥–∞—á–∞ 2.9: –û–±–Ω–æ–≤–∏—Ç—å phpunit.xml.dist

**–í—Ä–µ–º—è**: 30 –º–∏–Ω—É—Ç  
**–§–∞–π–ª**: `phpunit.xml.dist`

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å**:
1. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
3. –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–Ω—ã–µ test suites

**–ü—Ä–∏–º–µ—Ä**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<phpunit>
    <php>
        <env name="APP_ENV" value="test" force="true"/>
        <ini name="display_errors" value="1" />
        <ini name="error_reporting" value="-1" />
    </php>
    
    <testsuites>
        <testsuite name="Unit">
            <directory>tests/Unit</directory>
        </testsuite>
        <testsuite name="Integration">
            <directory>tests/Integration</directory>
        </testsuite>
        <testsuite name="E2E">
            <directory>tests/E2E</directory>
        </testsuite>
    </testsuites>
    
    <coverage>
        <include>
            <directory suffix=".php">lib/MBMigration</directory>
            <directory suffix=".php">dashboard/api</directory>
        </include>
        <exclude>
            <directory>vendor</directory>
            <directory>tests</directory>
        </exclude>
    </coverage>
</phpunit>
```

**–ß–µ–∫–ª–∏—Å—Ç**:
- [ ] phpunit.xml.dist –æ–±–Ω–æ–≤–ª–µ–Ω
- [ ] Test suites –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

---

### –ó–∞–¥–∞—á–∞ 2.10: –°–æ–∑–¥–∞—Ç—å —Ñ–∞–±—Ä–∏–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

**–í—Ä–µ–º—è**: 2-3 —á–∞—Å–∞  
**–§–∞–π–ª—ã**: 
- `tests/Helpers/Factories/MigrationPlatformFactory.php`
- `tests/Helpers/Factories/PageControllerFactory.php`

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å**:
1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–±—Ä–∏–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
3. –ü–æ–∑–≤–æ–ª—è—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–ü—Ä–∏–º–µ—Ä**:
```php
<?php
// tests/Helpers/Factories/MigrationPlatformFactory.php

namespace Tests\Helpers\Factories;

use MBMigration\MigrationPlatform;
use MBMigration\Core\Config;
use Tests\Helpers\Mocks\BrizyAPIMock;
use Tests\Helpers\Mocks\MBProjectDataCollectorMock;
use Monolog\Logger;
use Monolog\Handler\NullHandler;

class MigrationPlatformFactory
{
    public static function create(array $options = []): MigrationPlatform
    {
        $config = $options['config'] ?? new Config();
        $logger = $options['logger'] ?? new Logger('test');
        $logger->pushHandler(new NullHandler());
        
        $brizyApi = $options['brizyApi'] ?? new BrizyAPIMock();
        $mbCollector = $options['mbCollector'] ?? new MBProjectDataCollectorMock();
        
        return new MigrationPlatform(
            $config,
            $logger,
            $brizyApi,
            $mbCollector,
            $options['buildPage'] ?? '',
            $options['workspacesId'] ?? 0
        );
    }
}
```

**–ß–µ–∫–ª–∏—Å—Ç**:
- [ ] –§–∞–±—Ä–∏–∫–∞ –¥–ª—è MigrationPlatform —Å–æ–∑–¥–∞–Ω–∞
- [ ] –§–∞–±—Ä–∏–∫–∞ –¥–ª—è PageController —Å–æ–∑–¥–∞–Ω–∞
- [ ] –§–∞–±—Ä–∏–∫–∏ —É–¥–æ–±–Ω—ã –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

---

### –ó–∞–¥–∞—á–∞ 2.11: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –ë–î (Docker Compose)

**–í—Ä–µ–º—è**: 2-3 —á–∞—Å–∞  
**–§–∞–π–ª**: `docker-compose.test.yml`

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å**:
1. –°–æ–∑–¥–∞—Ç—å docker-compose –¥–ª—è —Ç–µ—Å—Ç–æ–≤
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ë–î (MySQL, PostgreSQL)
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤

**–ü—Ä–∏–º–µ—Ä**:
```yaml
version: '3.8'

services:
  test-mysql:
    image: mysql:8.0
    environment:
      MYSQL_DATABASE: test_migration
      MYSQL_ROOT_PASSWORD: test
    ports:
      - "3307:3306"
    tmpfs:
      - /var/lib/mysql  # –ë—ã—Å—Ç—Ä–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
      interval: 5s
      timeout: 3s
      retries: 5

  test-postgres:
    image: postgres:14
    environment:
      POSTGRES_DB: test_mb
      POSTGRES_USER: test
      POSTGRES_PASSWORD: test
    ports:
      - "5433:5432"
    tmpfs:
      - /var/lib/postgresql/data
```

**–ß–µ–∫–ª–∏—Å—Ç**:
- [ ] docker-compose.test.yml —Å–æ–∑–¥–∞–Ω
- [ ] MySQL –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] PostgreSQL –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)
- [ ] –ë–î –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∏ —Ä–∞–±–æ—Ç–∞—é—Ç

---

### –ó–∞–¥–∞—á–∞ 2.12: –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤

**–í—Ä–µ–º—è**: 1 —á–∞—Å  
**–§–∞–π–ª—ã**: 
- `scripts/test-unit.sh`
- `scripts/test-integration.sh`
- `scripts/test-all.sh`

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å**:
1. –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤
2. –î–æ–±–∞–≤–∏—Ç—å –≤ composer.json

**–ü—Ä–∏–º–µ—Ä**:
```bash
#!/bin/bash
# scripts/test-unit.sh

vendor/bin/phpunit tests/Unit --colors=always
```

**–û–±–Ω–æ–≤–∏—Ç—å composer.json**:
```json
{
  "scripts": {
    "test": "vendor/bin/phpunit -c phpunit.xml.dist",
    "test:unit": "vendor/bin/phpunit tests/Unit",
    "test:integration": "vendor/bin/phpunit tests/Integration",
    "test:e2e": "vendor/bin/phpunit tests/E2E",
    "test:coverage": "vendor/bin/phpunit --coverage-html coverage"
  }
}
```

**–ß–µ–∫–ª–∏—Å—Ç**:
- [ ] –°–∫—Ä–∏–ø—Ç—ã —Å–æ–∑–¥–∞–Ω—ã
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –≤ composer.json
- [ ] –°–∫—Ä–∏–ø—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

---

### –ó–∞–¥–∞—á–∞ 2.13: –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–í—Ä–µ–º—è**: 1-2 —á–∞—Å–∞  
**–§–∞–π–ª**: `tests/README.md`

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å**:
1. –û–ø–∏—Å–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–µ—Å—Ç–æ–≤
2. –û–±—ä—è—Å–Ω–∏—Ç—å, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–∫–∏
3. –ü—Ä–∏–≤–µ—Å—Ç–∏ –ø—Ä–∏–º–µ—Ä—ã

**–ß–µ–∫–ª–∏—Å—Ç**:
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- [ ] –ü—Ä–∏–º–µ—Ä—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã

---

## üìä –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∞–ø–∞

- [ ] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω–∞
- [ ] –ë–∞–∑–æ–≤—ã–π TestCase —Å–æ–∑–¥–∞–Ω
- [ ] –í—Å–µ –º–æ–∫–∏ —Å–æ–∑–¥–∞–Ω—ã (BrizyAPI, MBCollector, Database, S3Uploader)
- [ ] –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã —Å–æ–∑–¥–∞–Ω—ã
- [ ] .env.test –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] phpunit.xml.dist –æ–±–Ω–æ–≤–ª–µ–Ω
- [ ] –§–∞–±—Ä–∏–∫–∏ —Å–æ–∑–¥–∞–Ω—ã
- [ ] Docker Compose –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–æ–∑–¥–∞–Ω—ã
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∞

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É

–ü–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ –≠—Ç–∞–ø—É 3 —É–±–µ–¥–∏—Ç–µ—Å—å:

1. ‚úÖ –ú–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç —Å –º–æ–∫–∞–º–∏
2. ‚úÖ –¢–µ—Å—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç
3. ‚úÖ –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∏–∫—Å—Ç—É—Ä—ã
4. ‚úÖ –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–∏–ø—ã —Ç–µ—Å—Ç–æ–≤ (unit, integration, e2e)

**–¢–µ—Å—Ç**:
```php
// tests/Unit/ExampleTest.php
use Tests\TestCase;
use Tests\Helpers\Mocks\BrizyAPIMock;

class ExampleTest extends TestCase
{
    public function testMockWorks(): void
    {
        $mock = new BrizyAPIMock();
        $mock->setResponse('createProject', ['id' => 123]);
        
        $result = $mock->createProject(['name' => 'Test']);
        
        $this->assertEquals(123, $result['id']);
        $this->assertTrue($mock->wasCalled('createProject'));
    }
}
```

–ó–∞–ø—É—Å—Ç–∏—Ç—å: `composer test:unit`

---

## üìö –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

–°–º. [examples/stage-2/](../examples/stage-2/) –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤:
- –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–∫–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ú–æ–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ—Å—Ç—ã–º–∏** - –Ω–µ –ø–µ—Ä–µ—É—Å–ª–æ–∂–Ω—è–π—Ç–µ
2. **–§–∏–∫—Å—Ç—É—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö
3. **–¢–µ—Å—Ç–æ–≤—ã–µ –ë–î –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏** - –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å production –ë–î
4. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ** - –±—É–¥—É—â–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É

---

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–æ–∫–∏ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–µ
**–†–µ—à–µ–Ω–∏–µ**: –ù–∞—á–∞—Ç—å —Å –ø—Ä–æ—Å—Ç—ã—Ö –º–æ–∫–æ–≤, —É—Å–ª–æ–∂–Ω—è—Ç—å –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### –ü—Ä–æ–±–ª–µ–º–∞: –§–∏–∫—Å—Ç—É—Ä—ã –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–æ–±–µ–∑–ª–∏—á–µ–Ω–Ω—ã–µ) –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∏–∫—Å—Ç—É—Ä

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–µ—Å—Ç—ã –º–µ–¥–ª–µ–Ω–Ω—ã–µ
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SQLite –¥–ª—è unit —Ç–µ—Å—Ç–æ–≤, Docker —Ç–æ–ª—å–∫–æ –¥–ª—è integration

---

## üìÖ –ü—Ä–∏–º–µ—Ä–Ω—ã–π –ø–ª–∞–Ω –ø–æ –¥–Ω—è–º

**–ù–µ–¥–µ–ª—è 1**:
- –î–µ–Ω—å 1: –ó–∞–¥–∞—á–∏ 2.1-2.2 (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å)
- –î–µ–Ω—å 2-3: –ó–∞–¥–∞—á–∏ 2.3-2.6 (—Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–∫–æ–≤)
- –î–µ–Ω—å 4: –ó–∞–¥–∞—á–∞ 2.7 (—Ñ–∏–∫—Å—Ç—É—Ä—ã)
- –î–µ–Ω—å 5: –ó–∞–¥–∞—á–∏ 2.8-2.9 (–æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)

**–ù–µ–¥–µ–ª—è 2**:
- –î–µ–Ω—å 1-2: –ó–∞–¥–∞—á–∏ 2.10-2.11 (—Ñ–∞–±—Ä–∏–∫–∏ –∏ Docker)
- –î–µ–Ω—å 3: –ó–∞–¥–∞—á–∞ 2.12 (—Å–∫—Ä–∏–ø—Ç—ã)
- –î–µ–Ω—å 4: –ó–∞–¥–∞—á–∞ 2.13 (–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- –î–µ–Ω—å 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

---

**–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø**: [–≠—Ç–∞–ø 3: –ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤](./stage-3-writing-tests.md)
