# TASK-002: Проверка обработки desktop margin'ов

## Статус: ⏳ Ожидает выполнения

**Дата создания:** 2025-01-26  
**Приоритет:** Высокий

---

## Описание задачи

Проверить, правильно ли обрабатываются desktop margin'ы для секций:
- Правильно ли извлекаются margin'ы из DOM
- Правильно ли применяются margin'ы
- Учитываются ли additionalOptions для margin'ов
- Нужно ли обрабатывать margin collapse

---

## Текущая реализация

### Извлечение margin'ов

**Метод:** `getSectionStyles()` (строки 465-502)  
**Файл:** `lib/MBMigration/Builder/Layout/Common/Concern/SectionStylesAble.php`

Извлекаются следующие свойства:
- `margin-top`
- `margin-bottom`
- `margin-left`
- `margin-right`

### Применение margin'ов

**Метод:** `handleSectionStyles()` (строки 131-132)

```php
->set_marginType('ungrouped')
->set_marginLeft((int)($sectionStyles['margin-left'] ?? 0))
->set_marginRight((int)($sectionStyles['margin-right'] ?? 0))
->set_marginTop((int)($sectionStyles['margin-top'] ?? 0))
->set_marginBottom((int)($sectionStyles['margin-bottom'] ?? 0))
```

---

## Что нужно проверить

### Шаг 1: Проверить извлечение margin'ов из DOM

**Что делать:**
1. Открыть реальную страницу (lifespringhill.org, c3forchrist.org)
2. Проверить, правильно ли извлекаются margin'ы через селектор `[data-id="sectionId"]`
3. Сравнить извлеченные значения с computed styles в браузере

**Ожидаемый результат:**
- Margin'ы правильно извлекаются из DOM
- Значения соответствуют computed styles

**Критерии готовности:**
- [ ] Проверено на 2+ реальных страницах
- [ ] Результаты задокументированы

---

### Шаг 2: Проверить применение margin'ов

**Что делать:**
1. Проверить, правильно ли применяются margin'ы к секциям в Brizy
2. Убедиться, что `marginType: 'ungrouped'` устанавливается правильно
3. Проверить, что все стороны margin'ов применяются

**Ожидаемый результат:**
- Margin'ы правильно применяются к секциям
- Все стороны margin'ов учитываются

**Критерии готовности:**
- [ ] Проверено на мигрированных страницах
- [ ] Результаты задокументированы

---

### Шаг 3: Проверить учет additionalOptions

**Что делать:**
1. Проверить, могут ли `additionalOptions` перезаписать margin'ы
2. Убедиться, что логика приоритета правильная
3. Проверить примеры использования в темах

**Ожидаемый результат:**
- `additionalOptions` могут перезаписать margin'ы (это правильно)
- Логика приоритета работает корректно

**Критерии готовности:**
- [ ] Проверено на примерах из кода
- [ ] Результаты задокументированы

---

### Шаг 4: Проверить margin collapse

**Что делать:**
1. Изучить, как Brizy обрабатывает margin collapse
2. Проверить, нужно ли учитывать margin collapse при применении margin'ов
3. Протестировать на страницах с ненулевыми margin'ами (если есть)

**Ожидаемый результат:**
- Понятно, как Brizy обрабатывает margin collapse
- Определено, нужно ли что-то менять

**Критерии готовности:**
- [ ] Изучена документация/код Brizy
- [ ] Результаты задокументированы

---

## Результаты проверки

**Статус:** ⏳ Ожидает выполнения

**Найденные проблемы:**
- TBD

**Рекомендации:**
- TBD

---

## Следующие шаги

После выполнения проверки:
1. Если найдены проблемы - создать задачи на исправление
2. Если все правильно - перейти к TASK-003

---

## Связанные файлы

- `../analysis/current-implementation.md` - Текущая реализация
- `../analysis/real-pages-analysis.md` - Анализ реальных страниц
- `../analysis/issues-found.md` - Найденные проблемы
