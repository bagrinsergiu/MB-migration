# –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã Dashboard API

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–ø–∏—Å–∏
- **–ï–î–ò–ù–°–¢–í–ï–ù–ù–ê–Ø –±–∞–∑–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏**: `mb-migration.cupzc9ey0cip.us-east-1.rds.amazonaws.com`
- **–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –±–∞–∑—ã**: –¢–û–õ–¨–ö–û –î–õ–Ø –ß–¢–ï–ù–ò–Ø
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ö–æ—Å—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ `DatabaseService::validateWriteHost()`
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–ø–∏—Å–∏ –≤ –¥—Ä—É–≥—É—é –±–∞–∑—É –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `MG_DB_*` –∏–∑ `.env` —Ñ–∞–π–ª–∞:
  - `MG_DB_HOST` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–≤–µ–Ω `mb-migration.cupzc9ey0cip.us-east-1.rds.amazonaws.com`
  - `MG_DB_NAME` - –∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
  - `MG_DB_USER` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
  - `MG_DB_PASS` - –ø–∞—Ä–æ–ª—å
  - `MG_DB_PORT` - –ø–æ—Ä—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3306)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
dashboard/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ index.php                 # Entry point API
‚îÇ   ‚îú‚îÄ‚îÄ controllers/              # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MigrationController.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LogController.php
‚îÇ   ‚îî‚îÄ‚îÄ services/                 # –°–µ—Ä–≤–∏—Å—ã
‚îÇ       ‚îú‚îÄ‚îÄ DatabaseService.php   # –†–∞–±–æ—Ç–∞ —Å –ë–î (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ö–æ—Å—Ç–∞)
‚îÇ       ‚îú‚îÄ‚îÄ ApiProxyService.php   # –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É API
‚îÇ       ‚îî‚îÄ‚îÄ MigrationService.php  # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π
‚îú‚îÄ‚îÄ frontend/                     # React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–±—É–¥—É—â–µ–µ)
‚îî‚îÄ‚îÄ dashboard-plan.md             # –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```

## üîå API Endpoints

### –ë–∞–∑–æ–≤—ã–π URL
`http://localhost:8080/dashboard/api`

### –î–æ—Å—Ç—É–ø–Ω—ã–µ endpoints:

1. **GET /health** - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
2. **GET /migrations** - –°–ø–∏—Å–æ–∫ –º–∏–≥—Ä–∞—Ü–∏–π (—Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏)
3. **GET /migrations/:id** - –î–µ—Ç–∞–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–∏
4. **GET /migrations/:id/status** - –°—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–∏
5. **POST /migrations/run** - –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏
6. **POST /migrations/:id/restart** - –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏
7. **GET /logs/:brz_project_id** - –õ–æ–≥–∏ –º–∏–≥—Ä–∞—Ü–∏–∏
8. **GET /logs/recent** - –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã:
- `migrations_mapping` - –º–∞–ø–ø–∏–Ω–≥–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ (MB UUID <-> Brizy ID)
- `migration_result_list` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏–∏:
```json
{
  "value": {
    "status": "success",
    "brizy_project_id": 23131991,
    "mb_uuid": "3c56530e-ca31-4a7c-964f-e69be01f382a",
    "mb_site_id": 31383,
    "progress": {
      "Total": 18,
      "Success": 16,
      "processTime": 592.4
    },
    "message": {
      "warning": [...]
    }
  }
}
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∞—Å—Å–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `spl_autoload_register` –¥–ª—è namespace `Dashboard\`
- –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –≤ `dashboard/api/index.php`

### –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
- –û–±—Ä–∞–±–æ—Ç–∫–∞ `/dashboard/api/*` –≤ `public/index.php`
- –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ `dashboard/api/index.php` —Å –ø–µ—Ä–µ–¥–∞—á–µ–π `$context` –∏ `$request`

### –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏
- –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É API: `GET http://localhost:8080/?mb_project_uuid=...&brz_project_id=...`
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `mb_project_uuid`, `brz_project_id`, `mb_site_id`, `mb_secret`
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ: `brz_workspaces_id`, `mb_page_slug`, `mgr_manual`

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ö–æ—Å—Ç–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π (345 –∑–∞–ø–∏—Å–µ–π)
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É (251 —É—Å–ø–µ—à–Ω—ã—Ö)
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π –º–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –°–æ–∑–¥–∞–Ω–∏–µ React —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è WebSocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–∞ –æ—Ç—á–µ—Ç–æ–≤

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î –≤—ã–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `migration_result_list` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ú–∞–ø–ø–∏–Ω–≥–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ `migrations_mapping` –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
