# Рекомендации по выбору модели для анализа качества миграций

## Требования к модели

Для анализа качества миграции страниц нужна модель с поддержкой **Vision API** (работа с изображениями).

## Модели с поддержкой Vision API

### ✅ Рекомендуемые модели для Azure OpenAI:

1. **gpt-4-vision-preview** (или **gpt-4o**)
   - ✅ Полная поддержка Vision API
   - ✅ Высокое качество анализа изображений
   - ✅ Оптимизирована для работы с изображениями
   - ⚠️ Может быть дороже

2. **gpt-4-turbo**
   - ✅ Поддерживает Vision API
   - ✅ Хорошее качество анализа
   - ✅ Быстрее чем gpt-4

3. **gpt-4o**
   - ✅ Лучшая модель для Vision
   - ✅ Высокая скорость
   - ✅ Отличное качество анализа

### ❌ Модели БЕЗ поддержки Vision API:

- **gpt-4.1** - ⚠️ **НЕ поддерживает Vision API!**
- **gpt-3.5-turbo** - не поддерживает Vision API
- **text-davinci-003** - не поддерживает Vision API

## Проверка поддержки Vision API

Если вы используете модель, которая не поддерживает Vision API, вы получите ошибку типа:
```
The model 'gpt-4.1' does not support the 'image_url' content type
```

## Как проверить вашу модель

Запустите тестовый скрипт:
```bash
php lib/MBMigration/Analysis/test_azure_openai.php
```

Если тест с изображением не проходит, значит модель не поддерживает Vision API.

## Настройка правильной модели

В `.env` файле измените:
```env
# Если используете модель БЕЗ Vision API (не работает):
AZURE_API_MODEL_NAME=gpt-4.1

# Используйте одну из моделей С Vision API:
AZURE_API_MODEL_NAME=gpt-4-vision-preview
# или
AZURE_API_MODEL_NAME=gpt-4o
# или
AZURE_API_MODEL_NAME=gpt-4-turbo
```

## Проверка доступных моделей в Azure

1. Откройте Azure Portal
2. Перейдите в ваш Azure OpenAI ресурс
3. Откройте раздел "Deployments" или "Models"
4. Найдите модели с пометкой "Vision" или проверьте документацию

## Альтернатива: Использование OpenAI напрямую

Если в Azure нет подходящей модели с Vision API, можно использовать стандартный OpenAI:

```env
# Отключите Azure параметры (закомментируйте или удалите)
# AZURE_API_ENDPOINT=...
# AZURE_API_KEY=...
# AZURE_API_VERSION=...
# AZURE_API_MODEL_NAME=...

# Используйте стандартный OpenAI
OPENAI_API_KEY=sk-your-openai-key
OPENAI_MODEL=gpt-4o  # или gpt-4-vision-preview
```

## Стоимость

Модели с Vision API обычно дороже, так как обрабатывают изображения:
- Примерная стоимость: $0.01-0.05 за анализ одной страницы
- Зависит от размера изображений и сложности анализа

## Рекомендация

Для анализа качества миграции страниц **обязательно нужна модель с Vision API**, так как анализ включает:
- Сравнение скриншотов исходной и мигрированной страниц
- Визуальный анализ различий
- Определение отсутствующих элементов

**gpt-4.1 НЕ подходит** для этой задачи, если она не поддерживает Vision API.
