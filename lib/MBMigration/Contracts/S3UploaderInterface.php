<?php

namespace MBMigration\Contracts;

use Exception;

/**
 * Интерфейс для загрузки файлов в AWS S3
 * 
 * Этот интерфейс определяет контракт для загрузки файлов (логов) в AWS S3.
 * Интерфейс абстрагирует работу с S3 и позволяет использовать Dependency Injection
 * для тестирования с моками.
 * 
 * Примечание: Реализации интерфейса могут работать в неактивном режиме,
 * когда S3 неактивен. В этом случае методы возвращают пустые строки вместо
 * выброса исключений.
 * 
 * @package MBMigration\Contracts
 * @see \MBMigration\Core\S3Uploader
 */
interface S3UploaderInterface
{
    /**
     * Загрузить лог-файл миграции в S3 bucket
     * 
     * Загружает лог-файл миграции в S3 bucket и возвращает URL загруженного файла.
     * 
     * Особенности работы:
     * - Если S3 неактивен (statusActive = false), возвращает пустую строку
     * - Если файл не существует, возвращает пустую строку
     * - Если происходит ошибка AWS, логирует ошибку и возвращает пустую строку
     * - Не выбрасывает исключения при ошибках (обрабатывает внутри)
     * 
     * @param int $migrationId ID миграции (используется для формирования S3 ключа)
     * @param string $filePath Путь к файлу лога для загрузки
     * @return string URL загруженного файла в S3 или пустая строка, если:
     *                - S3 неактивен
     *                - Файл не найден
     *                - Произошла ошибка при загрузке
     * @throws Exception Указано в PHPDoc для совместимости, но метод фактически
     *                   обрабатывает все ошибки внутри и не выбрасывает исключения
     */
    public function uploadLogFile(int $migrationId, string $filePath): string;
}
