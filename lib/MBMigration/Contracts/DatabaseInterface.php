<?php

namespace MBMigration\Contracts;

use Exception;

/**
 * Интерфейс для работы с базами данных
 * 
 * Этот интерфейс определяет универсальный контракт для работы с различными типами БД
 * (MySQL, PostgreSQL и т.д.). Интерфейс абстрагирует различия между базами данных
 * и предоставляет единый API для выполнения запросов.
 * 
 * Интерфейс содержит минимальный набор методов, которые могут быть реализованы
 * в обоих классах (MySQL и PostgresSQL), обеспечивая обратную совместимость.
 * 
 * @package MBMigration\Contracts
 * @see \MBMigration\Layer\DataSource\driver\MySQL
 * @see \MBMigration\Layer\DataSource\driver\PostgresSQL
 */
interface DatabaseInterface
{
    /**
     * Выполнить SQL запрос и вернуть все строки результата
     * 
     * Выполняет SQL запрос с опциональными параметрами для подготовленных запросов
     * и возвращает все строки результата в виде массива ассоциативных массивов.
     * 
     * @param string $sql SQL запрос для выполнения
     * @param array $params Параметры для подготовленного запроса (по умолчанию [])
     * @return array Массив всех строк результата (каждая строка - ассоциативный массив)
     * @throws Exception Если запрос не выполнен или произошла ошибка БД
     */
    public function query(string $sql, array $params = []): array;

    /**
     * Выполнить SQL запрос и вернуть одну строку результата
     * 
     * Выполняет SQL запрос с опциональными параметрами для подготовленных запросов
     * и возвращает первую строку результата или null, если результат пуст.
     * 
     * @param string $sql SQL запрос для выполнения
     * @param array $params Параметры для подготовленного запроса (по умолчанию [])
     * @return array|null Первая строка результата (ассоциативный массив) или null
     * @throws Exception Если запрос не выполнен или произошла ошибка БД
     */
    public function queryOne(string $sql, array $params = []): ?array;
}
